# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase –¥–ª—è Kafeshka

## üìç –ü—É—Ç—å –∫ SQL —Ñ–∞–π–ª–∞–º

SQL —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `supabase/migrations/`:

1. **`supabase/migrations/001_initial_schema.sql`** - –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. **`supabase/migrations/002_add_chefs_remove_restaurant_role.sql`** - –ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–≤–∞—Ä–æ–≤
3. **`supabase/setup.sql`** - –ü–æ–ª–Ω—ã–π SQL —Ñ–∞–π–ª –¥–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ setup.sql

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Supabase Dashboard](https://app.supabase.com)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **SQL Editor**
4. –ù–∞–∂–º–∏—Ç–µ **New Query**
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ **`supabase/setup.sql`**
6. –í—Å—Ç–∞–≤—å—Ç–µ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
7. –ù–∞–∂–º–∏—Ç–µ **Run** (–∏–ª–∏ `Ctrl/Cmd + Enter`)

‚úÖ –ì–æ—Ç–æ–≤–æ! –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞.

---

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏:

### –®–∞–≥ 1: –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ö–µ–º–∞

1. –í Supabase Dashboard ‚Üí **SQL Editor**
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `supabase/migrations/001_initial_schema.sql`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –∫–æ–¥
4. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor
5. –ù–∞–∂–º–∏—Ç–µ **Run**

### –®–∞–≥ 2: –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ–≤–∞—Ä–æ–≤

1. –í —Ç–æ–º –∂–µ SQL Editor
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `supabase/migrations/002_add_chefs_remove_restaurant_role.sql`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –∫–æ–¥
4. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor
5. –ù–∞–∂–º–∏—Ç–µ **Run**

---

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Supabase CLI (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Supabase CLI:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Supabase CLI
npm install -g supabase

# –í–æ–π–¥–∏—Ç–µ –≤ Supabase
supabase login

# –°–≤—è–∂–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
supabase link --project-ref your-project-ref

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
supabase db push
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è SQL, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã:**
   - `restaurants`
   - `users`
   - `chefs`
   - `restaurant_admins`
   - `orders`
   - `order_status_history`
   - `banners`
   - `bot_settings`
   - `restaurant_categories`

2. **–ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
   - –í —Ç–∞–±–ª–∏—Ü–µ `bot_settings` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 4 –∑–∞–ø–∏—Å–∏
   - –í —Ç–∞–±–ª–∏—Ü–µ `restaurant_categories` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 6 –∫–∞—Ç–µ–≥–æ—Ä–∏–π

3. **RLS –≤–∫–ª—é—á–µ–Ω:**
   - –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –≤–∫–ª—é—á–µ–Ω–Ω—ã–π RLS
   - –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–∫—Ç–∏–≤–Ω—ã

4. **Storage –Ω–∞—Å—Ç—Ä–æ–µ–Ω:**
   - –í Supabase Dashboard ‚Üí Storage –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å bucket `images`
   - Bucket –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω—ã–º (public: true)

---

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

- –§–∞–π–ª `setup.sql` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `CREATE TABLE IF NOT EXISTS`, –ø–æ—ç—Ç–æ–º—É –µ–≥–æ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –±–µ–∑ –æ—à–∏–±–æ–∫
- –ú–∏–≥—Ä–∞—Ü–∏–∏ `001` –∏ `002` –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –ø–æ –ø–æ—Ä—è–¥–∫—É –∏ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
- –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—É—á–∏—Ç–µ **Service Role Key** –≤ Settings ‚Üí API –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ Backend –∏ Bot

---

## üì¶ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Storage –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ SQL, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ Storage:

1. –í Supabase Dashboard ‚Üí **Storage**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ bucket `images` —Å–æ–∑–¥–∞–Ω
3. –ï—Å–ª–∏ –Ω–µ—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª `supabase/storage_setup.sql` –≤ SQL Editor

–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ bucket –≤—Ä—É—á–Ω—É—é:
1. Storage ‚Üí **New bucket**
2. Name: `images`
3. Public bucket: **–í–∫–ª—é—á–µ–Ω–æ** ‚úÖ
4. Create bucket

## üîó –°—Å—ã–ª–∫–∏ –Ω–∞ —Ñ–∞–π–ª—ã

- –ü–æ–ª–Ω—ã–π SQL: [`supabase/setup.sql`](./supabase/setup.sql)
- Storage setup: [`supabase/storage_setup.sql`](./supabase/storage_setup.sql)
- –ú–∏–≥—Ä–∞—Ü–∏—è 1: [`supabase/migrations/001_initial_schema.sql`](./supabase/migrations/001_initial_schema.sql)
- –ú–∏–≥—Ä–∞—Ü–∏—è 2: [`supabase/migrations/002_add_chefs_remove_restaurant_role.sql`](./supabase/migrations/002_add_chefs_remove_restaurant_role.sql)

---

**–ì–æ—Ç–æ–≤–æ! –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.** üéâ

